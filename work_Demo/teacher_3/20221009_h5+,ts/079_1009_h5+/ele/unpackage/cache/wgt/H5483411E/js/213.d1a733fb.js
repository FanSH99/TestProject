"use strict";(self["webpackChunkele"]=self["webpackChunkele"]||[]).push([[213],{4213:function(t,s,i){i.r(s),i.d(s,{default:function(){return b}});var e=function(){var t=this,s=t._self._c;return s("div",{ref:"appraise",staticClass:"appraise"},[s("div",[t.scores?s("div",{staticClass:"scores"},[s("div",{staticClass:"left"},[s("div",{staticClass:"zonghe"},[t._v(" "+t._s(Math.ceil(t.scores.overall_score))+" ")]),s("div",{staticStyle:{"font-size":"16px",color:"#666",margin:"5px 0"}},[t._v(" 综合评价 ")]),s("div",{staticStyle:{"font-size":"13px",color:"#b4b4b4"}},[t._v(" 高于周边商家 "+t._s(Math.round(1e3*t.scores.compare_rating)/10)+"% ")])]),s("div",{staticClass:"right"},[s("div",{staticStyle:{"font-size":"15px",color:"#666"}},[t._v(" 服务态度： "),s("van-rate",{attrs:{size:7,readonly:"",color:"#f60","void-icon":"star","void-color":"#eee"},model:{value:t.scores.service_score,callback:function(s){t.$set(t.scores,"service_score",s)},expression:"scores.service_score"}}),s("span",{staticStyle:{"font-size":"13px","margin-left":"5px",color:"#f60"}},[t._v("4.7")])],1),s("div",{staticStyle:{"font-size":"15px",color:"#666",margin:"5px 0"}},[t._v(" 菜品评价： "),s("van-rate",{attrs:{size:7,readonly:"",color:"#f60","void-icon":"star","void-color":"#eee"},model:{value:t.scores.food_score,callback:function(s){t.$set(t.scores,"food_score",s)},expression:"scores.food_score"}}),s("span",{staticStyle:{"font-size":"13px","margin-left":"5px",color:"#f60"}},[t._v("4.8")])],1),s("div",{staticStyle:{"font-size":"14px",color:"#666"}},[t._v(" 送达时间："),s("span",{staticStyle:{"font-size":"13px",color:"#b4b4b4"}},[t._v(t._s(t.scores.deliver_time)+"分钟")])])])]):t._e(),s("div",{staticClass:"list"},[s("div",{staticClass:"tags"},t._l(t.tags,(function(i,e){return s("div",{key:e,on:{click:function(s){return t.changeTags(e,i.name)}}},[s("div",{class:{tag:!0,active_tag:t.active==e,unsatisfied:i.unsatisfied}},[t._v(" "+t._s(i.name)+" ("+t._s(i.count)+") ")])])})),0),s("div",{staticClass:"ratings"},t._l(t.list,(function(i,e){return s("div",{key:e,staticClass:"rating_item"},[s("div",{staticClass:"left"},[s("img",{attrs:{src:t._f("getUrl")(i.avatar),alt:""}})]),s("div",{staticClass:"center"},[s("div",{staticClass:"username"},[t._v(" "+t._s(i.username)+" ")]),s("div",[s("van-rate",{attrs:{icon:"star","void-icon":"star-o",readonly:"",size:"10",color:"#FF9A0D"},model:{value:i.rating_star,callback:function(s){t.$set(i,"rating_star",s)},expression:"item.rating_star"}}),s("span",{staticClass:"time_spent_desc"},[t._v(t._s(i.time_spent_desc))])],1),s("div",[s("div",{staticClass:"item_foods"},t._l(i.item_ratings,(function(i,e){return s("div",{key:e},[s("img",{staticClass:"foods_img",attrs:{src:t._f("getUrl")(i.image_hash),alt:""}})])})),0),s("div",{staticClass:"item_food_name"},t._l(i.item_ratings,(function(i,e){return s("div",{key:e,staticClass:"food_name"},[t._v(" "+t._s(i.food_name)+" ")])})),0)])]),s("div",{staticClass:"right"},[t._v(" "+t._s(i.rated_at)+" ")])])})),0)])])])},o=[],r=i(2922),n=(i(7658),"undefined"!==typeof window),a=n&&navigator.userAgent.toLowerCase();a&&/wechatdevtools/.test(a),a&&a.indexOf("android"),function(){if("string"===typeof a){var t=/os (\d\d?_\d(_\d)?)/,s=t.exec(a);if(!s)return!1;var i=s[1].split("_").map((function(t){return parseInt(t,10)}));return!!(13===i[0]&&i[1]>=4)}}();if(n){var l="test-passive";try{var c={};Object.defineProperty(c,"passive",{get:function(){!0}}),window.addEventListener(l,(function(){}),c)}catch(S){}}var h=function(t,s){for(var i in s)t[i]=s[i];return t},p=n&&document.createElement("div").style,u=function(){if(!n)return!1;for(var t=[{key:"standard",value:"transform"},{key:"webkit",value:"webkitTransform"},{key:"Moz",value:"MozTransform"},{key:"O",value:"OTransform"},{key:"ms",value:"msTransform"}],s=0,i=t;s<i.length;s++){var e=i[s];if(void 0!==p[e.value])return e.key}return!1}();function d(t){return!1===u?t:"standard"===u?"transitionEnd"===t?"transitionend":t:u+t.charAt(0).toUpperCase()+t.substr(1)}u&&"standard"!==u&&u.toLowerCase();d("transform"),d("transition");n&&d("perspective"),d("transitionTimingFunction"),d("transitionDuration"),d("transitionDelay"),d("transformOrigin"),d("transitionEnd"),d("transitionProperty");var f="plugins.pullUpLoad",v=[{key:"finishPullUp",name:"finishPullUp"},{key:"openPullUp",name:"openPullUp"},{key:"closePullUp",name:"closePullUp"},{key:"autoPullUpLoad",name:"autoPullUpLoad"}],g=v.map((function(t){return{key:t.key,sourceKey:f+"."+t.name}})),y="pullingUp",_=function(){function t(t){this.scroll=t,this.pulling=!1,this.watching=!1,this.init()}return t.prototype.init=function(){this.handleBScroll(),this.handleOptions(this.scroll.options.pullUpLoad),this.handleHooks(),this.watch()},t.prototype.handleBScroll=function(){this.scroll.registerType([y]),this.scroll.proxy(g)},t.prototype.handleOptions=function(t){void 0===t&&(t={}),t=!0===t?{}:t;var s={threshold:0};this.options=h(s,t),this.scroll.options.probeType=3},t.prototype.handleHooks=function(){var t=this;this.hooksFn=[];var s=this.scroll.scroller.scrollBehaviorY;this.registerHooks(this.scroll.hooks,this.scroll.hooks.eventTypes.contentChanged,(function(){t.finishPullUp()})),this.registerHooks(s.hooks,s.hooks.eventTypes.computeBoundary,(function(t){t.maxScrollPos>0&&(t.maxScrollPos=-1)}))},t.prototype.registerHooks=function(t,s,i){t.on(s,i,this),this.hooksFn.push([t,s,i])},t.prototype.watch=function(){this.watching||(this.watching=!0,this.registerHooks(this.scroll,this.scroll.eventTypes.scroll,this.checkPullUp))},t.prototype.unwatch=function(){this.watching=!1,this.scroll.off(this.scroll.eventTypes.scroll,this.checkPullUp)},t.prototype.checkPullUp=function(t){var s=this,i=this.options.threshold;1===this.scroll.movingDirectionY&&t.y<=this.scroll.maxScrollY+i&&(this.pulling=!0,this.scroll.once(this.scroll.eventTypes.scrollEnd,(function(){s.pulling=!1})),this.unwatch(),this.scroll.trigger(y))},t.prototype.finishPullUp=function(){var t=this;this.scroll.scroller.scrollBehaviorY.setMovingDirection(0),this.pulling?this.scroll.once(this.scroll.eventTypes.scrollEnd,(function(){t.watch()})):this.watch()},t.prototype.openPullUp=function(t){void 0===t&&(t={}),this.handleOptions(t),this.watch()},t.prototype.closePullUp=function(){this.unwatch()},t.prototype.autoPullUpLoad=function(){var t=this.options.threshold,s=this.scroll.scroller.scrollBehaviorY;if(!this.pulling&&this.watching){var i=-1,e=s.maxScrollPos+t+i;this.scroll.scroller.scrollBehaviorY.setMovingDirection(i),this.scroll.scrollTo(this.scroll.x,e,this.scroll.options.bounceTime)}},t.pluginName="pullUpLoad",t}(),m=_,k=i(9998),w=i(6870);r.ZP.use(m);var U={data(){return{active:0,pageScroll:null,scores:null,tags:[],food_score:5,query:{tag_name:"全部",offset:0,limit:10},list:[],isLoading:!1}},async mounted(){let t=await(0,k.SF)(this.$store.state.id);this.scores=t.data;let s=await(0,k.NJ)(this.$store.state.id);console.log(s),this.tags=s.data;let i=await(0,k.VJ)(this.$store.state.id,this.query);this.list=[...this.list,...i.data],this.$nextTick((()=>{this.pageScroll=new r.ZP(this.$refs.appraise,{click:!0,probeType:3,pullUpLoad:!0}),this.pageScroll.on("pullingUp",this.pullingUpHandler)}))},methods:{changeTags(t,s){this.active=t,this.query.tag_name=s,this.list=[],this.query.offset=0,this.getDataList()},async getDataList(){this.isLoading=!0,(0,w.Q)();let t=await(0,k.VJ)(this.$store.state.id,this.query);console.log(t),this.list=[...this.list,...t.data],this.isLoading=!1,(0,w.Z)(),this.pageScroll.finishPullUp(),this.pageScroll.refresh()},pullingUpHandler(){this.isLoading||(this.query.offset+=10,this.getDataList())}}},x=U,C=i(1001),P=(0,C.Z)(x,e,o,!1,null,"036d7fba",null),b=P.exports},6870:function(t,s,i){i.d(s,{Q:function(){return o},Z:function(){return r}});var e=i(8848);let o=()=>{(0,e.Z)({type:"loading",message:"加载中...",duration:0,forbidClick:!0})},r=()=>{e.Z.clear()}}}]);
//# sourceMappingURL=213.d1a733fb.js.map