"use strict";(self["webpackChunkele"]=self["webpackChunkele"]||[]).push([[279],{3136:function(t,s,i){i.d(s,{Z:function(){return c}});var a=function(){var t=this,s=t._self._c;return s("div",{staticClass:"shops",on:{click:t.goInfo}},[s("div",{staticClass:"shop_img"},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:`https://elm.cangdu.org/img/${t.shopInfo.image_path}`,expression:"`https://elm.cangdu.org/img/${shopInfo.image_path}`"}],attrs:{alt:""}})]),s("div",{staticClass:"shop_info"},[s("div",{staticStyle:{display:"flex",position:"relative"}},[s("van-tag",{attrs:{color:"#3190e8"}},[t._v("品牌")]),s("span",{staticClass:"ys"},[t._v(t._s(t.shopInfo.name))]),s("ul",{staticClass:"ul"},t._l(t.shopInfo.supports,(function(i,a){return s("li",{key:a},[t._v(t._s(i.icon_name))])})),0)],1),s("div",{staticClass:"shop_rot"},[s("van-rate",{attrs:{size:8,color:"#ffd21e","void-icon":"star","void-color":"#eee"},model:{value:t.shopInfo.rating,callback:function(s){t.$set(t.shopInfo,"rating",s)},expression:"shopInfo.rating"}}),s("span",{staticClass:"rate"},[t._v(t._s(t.shopInfo.rating))]),s("span",{staticClass:"sale"},[t._v("月销"+t._s(t.shopInfo.recent_order_num)+"单")]),s("span",{staticClass:"tag"},[t.shopInfo.delivery_mode?s("van-tag",{attrs:{type:"primary"}},[t._v(t._s(t.shopInfo.delivery_mode.text))]):t._e(),t._l(t.shopInfo.supports,(function(i,a){return s("span",{key:a},["准"==i.icon_name?s("van-tag",{staticClass:"s",attrs:{plain:"",type:"primary"}},[t._v("准时达")]):t._e()],1)}))],2)],1),s("div",{staticClass:"shop_song"},[s("span",[t._v(" ￥"+t._s(t.shopInfo.float_minimum_order_amount)+"起送 / 配送费约¥"+t._s(t.shopInfo.float_delivery_fee)+" ")]),s("span",[s("span",{staticClass:"gl"},[t._v(t._s(t.shopInfo.distance)+" /")]),t._v(" "),s("span",{staticClass:"time"},[t._v(t._s(t.shopInfo.order_lead_time))])])])])])},e=[],n=(i(7658),{props:{shopInfo:Object},data(){return{value:8}},methods:{goInfo(){this.$router.push({path:"/shop/info/"+this.shopInfo.id})}}}),o=n,l=i(1001),r=(0,l.Z)(o,a,e,!1,null,"63f34dfb",null),c=r.exports},1279:function(t,s,i){i.r(s),i.d(s,{default:function(){return d}});i(7658);var a=function(){var t=this,s=t._self._c;return s("div",{staticClass:"page pagehome"},[s("my-nav-bar",{scopedSlots:t._u([{key:"left",fn:function(){return[s("van-icon",{attrs:{name:"search"}})]},proxy:!0},{key:"center",fn:function(){return[t.city?s("div",{staticClass:"cityname",on:{click:function(s){return t.$router.push("/city")}}},[t._v(" "+t._s(t.city.name)+" ")]):t._e()]},proxy:!0},{key:"right",fn:function(){return[t.$store.state.user_id?s("div",[s("van-icon",{attrs:{name:"contact"}})],1):s("div",[t._v("登录 | 注册")])]},proxy:!0}])}),0==t.cateList.length?s("div",[s("my-cate")],1):s("div",{staticClass:"mySwiper"},[s("van-swipe",{staticClass:"my-swipe",attrs:{autoplay:3e3,"indicator-color":"#3190e8"}},t._l(t.cateList,(function(i,a){return s("van-swipe-item",{key:a},[s("div",{staticClass:"cate"},t._l(i,(function(i,a){return s("div",{key:a,staticClass:"cate_item",on:{click:function(s){return t.goInfo(i.id,i.title)}}},[s("img",{attrs:{src:"https://fuss10.elemecdn.com"+i.image_url,alt:""}}),s("p",[t._v(" "+t._s(i.title)+" ")])])})),0)])})),1)],1),0!=t.shopList.length?s("div",{staticClass:"shopList"},[s("div",{staticClass:"title"},[s("van-icon",{attrs:{name:"shop-o"}}),t._v(" 附近商家")],1),s("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了",offset:"50"},on:{load:t.onLoad},model:{value:t.loading,callback:function(s){t.loading=s},expression:"loading"}},[s("div",{staticClass:"list"},t._l(t.shopList,(function(t,i){return s("div",{key:i,staticClass:"list_item"},[s("myshop",{attrs:{shopInfo:t}})],1)})),0)])],1):s("div",{staticClass:"loading"},t._l(6,(function(t,a){return s("img",{key:a,attrs:{src:i(3005),alt:""}})})),0)],1)},e=[],n=i(2419),o=i(6870),l=i(3136),r={data(){return{city:null,cateList:[],shopList:[],offset:0,loading:!1,finished:!1}},components:{myshop:l.Z},async created(){let t=this.$route.query.geohash;(0,o.Q)();let s=await(0,n.k$)(t);this.city=s.data,(0,o.Z)();let i=await(0,n.k_)(),a=i.data.length/8;a=Math.floor(a);let e=[];for(let n=0;n<a;n++)e[n]=i.data.slice(8*n,8*(n+1));if(i.data.length%8!=0){i.data;e[a]=i.data.slice(8*a)}this.cateList=e,this.getDataList()},methods:{async getDataList(){let t={latitude:this.city.latitude,longitude:this.city.longitude,offset:this.offset},s=await(0,n.IU)(t);console.log(s),this.shopList=[...this.shopList,...s.data],this.loading=!1,0==s.data.length&&(this.finished=!0)},onLoad(){this.offset+=20,console.log("滚动到底部啦"),this.getDataList()},goInfo(t,s){this.$router.push({path:"/cate/info",query:{latitude:this.city.latitude,longitude:this.city.longitude,id:t,title:s}})}}},c=r,u=i(1001),p=(0,u.Z)(c,a,e,!1,null,"3dc7e24c",null),d=p.exports},2419:function(t,s,i){i.d(s,{IU:function(){return o},k$:function(){return e},k_:function(){return n}});var a=i(6938);let e=t=>(0,a.P)(`/v2/pois/${t}`),n=()=>(0,a.P)("/v2/index_entry"),o=t=>(0,a.P)("/shopping/restaurants",t)},6870:function(t,s,i){i.d(s,{Q:function(){return e},Z:function(){return n}});var a=i(8848);let e=()=>{(0,a.Z)({type:"loading",message:"加载中...",duration:0,forbidClick:!0})},n=()=>{a.Z.clear()}},3005:function(t,s,i){t.exports=i.p+"img/loading.7019a6ca.svg"}}]);
//# sourceMappingURL=279.f1d44f6f.js.map