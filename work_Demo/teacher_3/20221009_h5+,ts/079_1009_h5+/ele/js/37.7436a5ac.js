"use strict";(self["webpackChunkele"]=self["webpackChunkele"]||[]).push([[37],{3037:function(t,s,a){a.r(s),a.d(s,{default:function(){return v}});var i=function(){var t=this,s=t._self._c;return s("div",{staticClass:"page"},[s("my-nav-bar",{scopedSlots:t._u([{key:"left",fn:function(){return[s("div",{staticClass:"lefts"},[s("van-icon",{attrs:{name:"arrow-left"},on:{click:function(s){return t.$router.go(-1)}}})],1)]},proxy:!0},{key:"center",fn:function(){return[s("div",[t._v(" 确认订单 ")])]},proxy:!0}])}),s("div",[0==t.ArrayList.length?s("van-contact-card",{attrs:{type:"add","add-text":"请添加一个收货地址"}}):s("van-contact-card",{attrs:{type:"edit",name:t.ArrayList[0].name+" "+t.ArrayList[0].phone,tel:t.ArrayList[0].address}})],1),s("div",{staticClass:"sdsj"},[s("div",{staticClass:"time"},[t._v(" 送达时间 ")]),t.orderinfo?s("div",{staticClass:"right"},[s("p",{staticClass:"p1"},[t._v("尽快送达 | 预计 "+t._s(t.orderinfo.delivery_reach_time))]),s("p",{staticClass:"p2"},[s("van-tag",{staticClass:"tag",attrs:{type:"primary"}},[t._v("蜂鸟专送")])],1)]):t._e()]),s("div",{staticStyle:{margin:"10px 0"}},[s("van-cell",{attrs:{title:"支付方式",value:"在线支付","is-link":""},on:{click:function(s){t.show=!0}}}),s("van-cell",{attrs:{title:"红包",value:"暂时只在饿了么APP中支持"}})],1),t.orderinfo?s("div",{staticClass:"foods"},[s("div",{staticClass:"foodsname"},[s("img",{staticClass:"shop_img",attrs:{src:`https://elm.cangdu.org/img/${t.orderinfo.cart.restaurant_info.image_path}`,alt:""}}),t._v(" "),s("span",[t._v(t._s(t.orderinfo.cart.restaurant_info.name))])]),s("div",[t._l(t.orderinfo.cart.groups,(function(a,i){return s("div",{key:i,staticClass:"foodslist"},[s("span",[t._v(" "+t._s(a[0].name)+" ")]),s("span",[s("span",{staticClass:"num"},[t._v(" ✖ "+t._s(a[0].quantity))]),s("span",[t._v("￥"+t._s(a[0].price))])])])})),t._l(t.orderinfo.cart.extra,(function(a){return s("div",{key:a.name,staticClass:"foodslist"},[s("span",[t._v(t._s(a.name))]),s("span",[t._v("￥"+t._s(a.price))])])})),s("div",{staticClass:"foodslist",staticStyle:{"border-bottom":"1px solid #F1F1F1"}},[s("span",[t._v("配送费")]),s("span",[t._v("￥"+t._s(t.orderinfo.cart.deliver_amount))])]),s("div",{staticClass:"foodslist"},[s("span",[t._v("订单￥"+t._s(t.orderinfo.cart.total))]),s("span",{staticClass:"vc"},[t._v("待支付")])]),s("div",{staticClass:"foodslist"},[s("span"),s("span",{staticClass:"vc"},[t._v(t._s(t.orderinfo.cart.total))])])],2),s("div",[s("div",{staticClass:"foodslist"},[s("span",[t._v("订单备注")]),s("span",{staticClass:"live"},[t._v(" 口味、偏好等 "),s("van-icon",{attrs:{name:"arrow"}})],1)]),s("div",{staticClass:"foodslist"},[s("span",[t._v("发票抬头")]),s("span",{staticClass:"live"},[t._v(" 不需要开发票 "),s("van-icon",{attrs:{name:"arrow"}})],1)])])]):t._e(),t.orderinfo?s("div",{staticClass:"footer"},[s("div",[t._v("待支付￥"+t._s(t.orderinfo.cart.total))]),s("div",{staticClass:"btn",on:{click:t.getOrder}},[t._v("确认下单")])]):t._e(),s("van-popup",{style:{height:"30%"},attrs:{position:"bottom"},model:{value:t.show,callback:function(s){t.show=s},expression:"show"}},[t.orderinfo?s("div",[s("div",{staticClass:"title"},[t._v(" 支付方式 ")]),s("div",[s("van-radio-group",{model:{value:t.radio,callback:function(s){t.radio=s},expression:"radio"}},t._l(t.orderinfo.payments,(function(a,i){return s("div",{key:i,staticClass:"payments"},[s("div",{class:{disable:!a.is_online_payment}},[t._v(" "+t._s(a.name)+"("+t._s(a.description)+") ")]),s("div",[s("van-radio",{attrs:{"checked-color":"#4cd964",disabled:!a.is_online_payment}})],1)])})),0)],1)]):t._e()])],1)},e=[],r=(a(7658),a(7535)),o=a(8848),n={data(){return{ArrayList:[],orderinfo:null,data:null,show:!1,radio:1,data:null,entities:[]}},async created(){let t=this.$store.state.cartList,s=t[this.$store.state.id];s||this.$router.go(-1);let a=[];s.forEach((t=>{let s={id:t.food_id,name:t.name,packing_fee:t.packing_fee,price:t.price,quantity:t.num,sku_id:t.sku_id,specs:t.specs,stock:t.stock};a.push([s])})),this.entities=a;let i={restaurant_id:this.$store.state.id,geohash:localStorage.getItem("geohash"),entities:a};console.log(i);let e=await(0,r.LV)(i);console.log(e),this.orderinfo=e.data;let o=await(0,r.mZ)(this.$store.state.user_id);console.log(o),this.ArrayList=o.data},methods:{async getOrder(){let t=this.$store.state.user_id,s=this.orderinfo.id;if(0==this.ArrayList.length)return void o.Z.fail("请您选择收获地址");let a={address_id:this.ArrayList[0].id,restaurant_id:this.$store.state.id,geohash:localStorage.getItem("geohash"),description:"",entities:this.entities};console.log(a);let i=await(0,r.El)(t,s,a);1===i.data.status&&this.$router.push({path:"/pay"})}}},l=n,d=a(1001),c=(0,d.Z)(l,i,e,!1,null,"38086c38",null),v=c.exports},7535:function(t,s,a){a.d(s,{El:function(){return o},Fw:function(){return n},LV:function(){return e},mZ:function(){return r}});var i=a(6938);let e=t=>(0,i.j)("/v1/carts/checkout",t),r=t=>(0,i.P)(`/v1/users/${t}/addresses`),o=(t,s,a)=>(0,i.j)(`/v1/users/${t}/carts/${s}/orders`,a),n=(t,s)=>(0,i.P)(`/bos/v2/users/${t}/orders`,s)}}]);
//# sourceMappingURL=37.7436a5ac.js.map