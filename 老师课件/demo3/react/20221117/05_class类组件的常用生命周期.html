<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div id="app">

    </div>
</body>
<script src="../react.development.js"></script>
<script src="../react-dom.development.js"></script>
<!-- babel.js 用来将jsx编译为js -->
<script src="https://cdn.staticfile.org/babel-standalone/6.26.0/babel.min.js"></script>
<!-- 告诉script标签在里面可以写任意代码 写完后可以使用babel进行编译 -->
<script type="text/babel">
    /* 
     函数式组件与class类组件的区别：
     函数式组件又称无状态组件，函数式组件通常又来做一些数据渲染
     class类组件有状态组件，通常用来编写一些复杂业务逻辑
     注意：class类组件具有生命周期，函数式组件他是没有生命周期。
    */

   /* 
    生命周期：描述组件从创建到销毁的过程
    react类组件生命周期分为三部分：
    1.初始化阶段:
     1.1 constructor:当类组件创建时就会立即执行constructor钩子函数，这个钩子函数中必须要使用super 继承react Component类；在这个钩子函数我们通常可以用来定义state状态，类属性，绑定函数this指向，在这个钩子函数中不能使用this.setState更新状态否责报错，
     通常不会在该生命周期请求数据,只会调用一次
     1.2 render: render生命周期react会根据你写的模板生成虚拟dom 不能发送请求不能使用this.setState更新状态否责就会进入死循环。通常在该生命周期用来渲染state状态、props。只要状态发生改变就会被调用
     1.3 componentDidmount:组件渲染后，可以写任意业务逻辑，我们通常在该生命周期发送http请求 只会调用一次
    2.更新阶段:
     2.1 render:生成更新后的新虚拟dom
     2.2 componentDidUpdateL:组件更新后调用 初始化不调用
    3.销毁阶段：
     3.1 componentWillUnmount： 组件销毁时触发 清楚定时器 ...

   */
   class App extends React.Component{
        constructor(){
            console.log("构造函数");
            super();
            this.state= {
                name:"张三"
            }
            this.age=18;
            // console.log(this)
           this.lookthis =  this.lookthis.bind(this);
        //    this.setState({
        //       name:"李四"
        //    })
        // 
        }
         render(){
            // this.setState({
            //     name:"李四"
            // })
            console.log("生成dom")
            return (
               <div>
                <h1>app组件---{this.state.name}</h1>
                {
                    this.state.name==='张三' && <Child/>
                }
                <button onClick={this.lookthis}>this指向</button> 
               </div>
            )
         }
         componentDidMount(){
            console.log("渲染完成")
            let xhr = new XMLHttpRequest();
            xhr.open("get", `https://game.gtimg.cn/images/lol/act/img/js/heroList/hero_list.js`);
            xhr.send();
            xhr.onreadystatechange = () => {
                if (xhr.readyState === 4) {
                    let data = JSON.parse(xhr.response);
                    console.log(data)
                }
            }
         }
         lookthis(){
            console.log(this)
             this.setState({
                name:"李四"
            })
         }
         componentDidUpdate(){
            console.log("组件更新后")
         }
         componentWillUnmount(){
            console.log("组件销毁时触发")  //清楚一些定时器 取消全局时间
         }
   }

   class Child extends React.Component{
        timer=null
        render(){
            return (
                <div>子组件</div>
            )
        }
        componentDidMount(){
            window.onresize = ()=>{
                console.log("窗口改变了")
            }
            this.timer =setInterval(()=>{
                console.log(11111)
            },1000)
        }   
        componentWillUnmount(){
            // 清楚定时器
            clearInterval(this.timer);
            window.onresize = null;
        }
   }
   ReactDOM.render(<App/>,document.getElementById("app"))
</script>
</html>